// Generated by CoffeeScript 1.10.0
(function() {
  angular.module('InterCityBus').controller('IndexController', function($state, $rootScope, $scope, $timeout, $http, City, Hotline) {
    $scope.$on('$stateChangeSuccess', function(ev, to, toParams, from, fromParams) {
      if (to.name === 'index' && fromParams.start && fromParams.end) {
        return $scope.cities.$promise.then(function() {
          $scope.startCity = $scope.cities[fromParams.start - 1];
          return $scope.endCity = $scope.cities[fromParams.end - 1];
        });
      }
    });
    $scope.swapCity = function() {
      var tmp;
      tmp = this.startCity;
      this.startCity = this.endCity;
      return this.endCity = tmp;
    };
    $scope.cities = City.query();
    $scope.hotlines = Hotline.query({
      limit: 6
    });
    $scope.search = function(start, end) {
      return $state.go('search', {
        start: start,
        end: end
      });
    };
    return $scope.searchBusline = function() {
      if (!this.startCity || !this.endCity) {
        alert("必须选好出发和终点城市哦");
        return;
      }
      if (this.startCity.id === this.endCity.id) {
        alert("出发地和终点地不能一样哦");
        return;
      }
      return $state.go('search', {
        start: this.startCity.id,
        end: this.endCity.id
      });
    };
  });

}).call(this);

//# sourceMappingURL=index.controller.js.map
