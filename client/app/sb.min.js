(function(){var t;t=angular.module("InterCityBus",["ui.router","ngCookies","ngResource","InterCityBus.services","InterCityBus.controllers"]).config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(t,e,n,r){return n.html5Mode(!0),r.interceptors.push("authInterceptor")}]).factory("authInterceptor",["$rootScope","$q","$cookies","$injector",function(t,e,n,r){return{request:function(t){return t.headers=t.headers||{},n.get("token")&&(t.headers.Authorization="Bearer "+n.get("token")),t},responseError:function(t){var i;return 401===t.status?((i||(i=r.get("$state"))).go("login"),n.remove("token"),e.reject(t)):e.reject(t)}}}]).run(["$rootScope","$state",function(t,e){return t.$on("$stateChangeStart",function(t,n){return console.log(n),console.log(n.url),"/"===n.url?(t.preventDefault(),e.go("search")):void 0})}]),angular.module("InterCityBus.services",[]),angular.module("InterCityBus.controllers",[])}).call(this),function(){angular.module("InterCityBus").controller("BuslineController",["$scope","$window","$document","$stateParams","$http","$timeout","$interval","Busline","Utils",function(t,e,n,r,i,o,u,s,l){return t.dial=function(n){var r;return o(function(){return t.finishBook=!0},5e3),r=e.open("tel:"+n,"_blank"),!1},t.purify=function(t){return t.replace(/\s+/g,"")},t.busline=s.get({id:r.id}),t.$on("$viewContentLoaded",function(t){return o(function(){return l.fixTooLongIssue()},100),o(function(){return l.fixTooLongIssue()},500)}),t.closeit=function(){return t.finishBook=!1},t.shareit=function(){return t.shareIt=!0,o(function(){return t.shareIt=!1},1e4)}}])}.call(this),function(){angular.module("InterCityBus").config(["$stateProvider",function(t){return t.state("busline",{url:"/busline/:id",templateUrl:"app/busline/busline.html",controller:"BuslineController"})}]),angular.module("InterCityBus.services").factory("Busline",["$resource",function(t){return t("/api/buslines/:id",{id:"@id"},{update:{method:"PUT"}})}])}.call(this),function(){angular.module("InterCityBus").controller("FeedbackController",["$scope","$http",function(t,e){return t.submitFeedback=function(){return alert("您的反馈我们已经收到！")}}])}.call(this),function(){angular.module("InterCityBus").config(["$stateProvider",function(t){return t.state("feedback",{url:"/feedback",templateUrl:"app/feedback/feedback.html",controller:"FeedbackController"})}])}.call(this),function(){angular.module("InterCityBus").controller("IndexController",["$state","$scope","$http","City","Hotline",function(t,e,n,r,i){return e.swapCity=function(){var t;return t=this.startCity,this.startCity=this.endCity,this.endCity=t},e.cities=r.query(),e.hotlines=i.query(),e.search=function(e,n){return t.go("search",{start:e,end:n})},e.searchBusline=function(){return this.startCity&&this.endCity?this.startCity.id===this.endCity.id?void alert("出发地和终点地不能一样哦"):t.go("search",{start:this.startCity.id,end:this.endCity.id}):void alert("必须选好出发和终点城市哦")}}])}.call(this),function(){angular.module("InterCityBus").config(["$stateProvider",function(t){return t.state("index",{url:"/index",templateUrl:"app/index/index.html",controller:"IndexController"})}]),angular.module("InterCityBus.services").factory("City",["$resource",function(t){return t("/api/cities/:id",{id:"@id"},{update:{method:"PUT"}})}]).factory("Hotline",["$resource",function(t){return t("/api/hotlines/:id",{id:"@id"})}])}.call(this),function(){angular.module("InterCityBus").controller("SearchController",["$state","$scope","$window","$stateParams","$http","$timeout","City","Busline","Utils",function(t,e,n,r,i,o,u,s,l){return e.cities=u.query(),e.startCityId=r.start,e.endCityId=r.end,e.buslines=s.query({start:r.start,end:r.end},function(){return e.showNoResult=0===e.buslines.length}),e.viewDetailBusline=function(e){return t.go("busline",{id:e})},e.$on("$viewContentLoaded",function(t){return o(function(){return l.fixTooLongIssue()},100),o(function(){return l.fixTooLongIssue()},500)}),e.research=function(){return t.go("index")},e.requestNewLine=function(){var n,r,i;return i=e.cities[e.startCityId].name,n=e.cities[e.endCityId].name,r="您专属定制的"+i+"-"+n+"的路线小巴已经收到，将会尽快开通，届时将第一时间通知您！",alert(r),t.go("index")}}])}.call(this),function(){angular.module("InterCityBus").config(["$stateProvider",function(t){return t.state("search",{url:"/search?start&end",templateUrl:"app/search/search.html",controller:"SearchController"})}]),angular.module("InterCityBus.services").factory("Utils",function(){return{fixTooLongIssue:function(){var t,e,n,r;return t=$(".line_name"),n=$("ul[class='start']").width(),r=$("ul[class='end']").width(),e=t.width(),n+r>e?(console.log("ok fix it"),$("ul[class='end']").width(r),$("ul[class='end']").css("right",-(n+r-e)),t.css("max-width",e).height("9.4rem").css("margin-top",0).css("overflow-x","auto").css("overflow-y","hidden"),$(".white_bg_right").css("right",-(n+r-e)),t.children().each(function(t,e){return $(e).css("margin-top","1.1rem")})):void 0}}})}.call(this);